$(document).ready(
    function() {

        $('[data-toggle="tooltip"]').tooltip()

        $('.rbins-lateral-tabs li').on(
                'click',
                function (event) {
                    if (!$(this).hasClass('active')) {
                        event.preventDefault();
                        var target = $(this).data('target');
                        $(target).addClass('in').fadeIn();
                        $('.rbins-tab-content').not(target).removeClass('in');
                        $('.rbins-lateral-tabs li, .rbins-lateral-tabs li a').removeClass('active');
                        $(this).addClass('active');
                    }

                    return true;

                }
        );

        $('.toggle_view_edit_container a').on(
                'click',
                function(event) {
                    event.preventDefault();
                    $(this).toggle(
                            'fade',
                            200,
                            function(){
                                $(this).next().toggle(
                                        'fade',
                                        300,
                                        function() {
                                            if ($(this).is(':visible')) {
                                                $(this).css('display', 'inline-block');
                                            }
                                        }
                                );
                                $(this).prev().toggle(
                                        'fade',
                                        300,
                                        function() {
                                            if ($(this).is(':visible')) {
                                                $(this).css('display', 'inline-block');
                                            }
                                        }
                                );
                            }
                    );
                }
        );

        $('.rbins-remove-related').on(
                'click',
                function(event) {
                    event.preventDefault();
                    if ( !confirm("{{ 'app.message.related.removeConfirmation'|trans({}, "messages") }}")) {
                        return false;
                    }
                    return false;
                }
        );

        $('.rbins-remove-btn').on(
                'click',
                function(event) {
                    event.preventDefault();
                    if ( !confirm("{{ 'app.message.main.removeConfirmation'|trans({}, "messages", app.request.getLocale()) }}")) {
                        return false;
                    }

                    $.ajax(
                            {
                                url: $(this).attr('href'),
                                success: function(data){
                                    window.location.href = Routing.generate(
                                            data.route,
                                            {
                                                _locale: "{{ app.request.getLocale() }}"
                                            });
                                },
                                error: function(jqXHR){
                                    var routeName = '';
                                    if ( jqXHR.status == '404' ) {
                                        routeName = 'app_homepage';
                                    }
                                    else if ( jqXHR.status == '419' ) {
                                        alert('An error occured: '+jqXHR.responseText);
                                    }
                                    if ( routeName != '' ) {
                                        window.location.href = Routing.generate(
                                                routeName,
                                                {
                                                    _locale: "{{ app.request.getLocale() }}"
                                                });
                                    }
                                }
                            }
                    );

                    return false;
                }
        );
    }
);
